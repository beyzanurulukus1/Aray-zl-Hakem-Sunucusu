{"ast":null,"code":"var _jsxFileName = \"/Users/beyza/Desktop/koustech/Client/src/map/mapView.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Circle, Popup } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport startSignalR from '../signalr/telemetriClient';\nimport L from 'leaflet';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'\n});\nconst DEFAULT_CENTER = [41.51, 36.12];\nconst SERVER_BASE_URL = 'http://localhost:5000/api';\n\n// Ä°HA konumlarÄ±nÄ± Server'dan alacaÄŸÄ±mÄ±z iÃ§in, bunlarÄ± global bir ref'te tutalÄ±m (tÃ¼m Ä°HA'larÄ± simÃ¼le etmek iÃ§in)\nconst allUAVs = {};\nconst MapView = () => {\n  _s();\n  // State'ler\n  const [uavPositions, setUAVPositions] = useState([]); // CanlÄ± Ä°HA konumlarÄ±\n  const [qrPosition, setQrPosition] = useState(null);\n  const [hssZones, setHssZones] = useState([]);\n  const [center, setCenter] = useState(DEFAULT_CENTER);\n  const connectionRef = useRef(null); // SignalR baÄŸlantÄ±sÄ±nÄ± tutmak iÃ§in ref\n\n  // --- 1. BaÅŸlangÄ±Ã§ta Statik KonumlarÄ± (QR ve HSS) Ã‡ekme ---\n  useEffect(() => {\n    // QR ve HSS Ã§ekme kodlarÄ± aynÄ± kalÄ±r...\n    fetch(`${SERVER_BASE_URL}/qr_koordinati`).then(res => res.json()).then(data => {\n      if (data.qrEnlem && data.qrBoylam) {\n        const pos = [data.qrEnlem, data.qrBoylam];\n        setQrPosition(pos);\n        setCenter(pos);\n      }\n    }).catch(error => console.error(\"QR Ã§ekilemedi:\", error));\n    fetch(`${SERVER_BASE_URL}/hss_koordinatlari`).then(res => res.json()).then(data => {\n      if (data && data.hss_koordinat_bilgileri) {\n        setHssZones(data.hss_koordinat_bilgileri);\n      }\n    }).catch(error => console.error(\"HSS Ã§ekilemedi:\", error));\n  }, []);\n\n  // --- 2. SignalR Ä°stemcisine BaÄŸlanma ve CanlÄ± Veri AkÄ±ÅŸÄ± ---\n  useEffect(() => {\n    // Gelen telemetri verisini iÅŸleyen fonksiyon\n    const handleTelemetry = telemetryData => {\n      // Sadece konum ve numara bilgilerini alÄ±yoruz\n      const {\n        takim_numarasi,\n        iha_enlem,\n        iha_boylam,\n        iha_irtifa\n      } = telemetryData;\n\n      // Global depoyu gÃ¼ncelle\n      allUAVs[takim_numarasi] = {\n        num: takim_numarasi,\n        lat: iha_enlem,\n        lng: iha_boylam,\n        irtifa: iha_irtifa\n      };\n\n      // State'i gÃ¼ncelle ve haritayÄ± yeniden Ã§izdir\n      setUAVPositions(Object.values(allUAVs));\n    };\n\n    // BaÄŸlantÄ±yÄ± baÅŸlat\n    connectionRef.current = startSignalR(handleTelemetry);\n\n    // Komponent temizlendiÄŸinde baÄŸlantÄ±yÄ± kapat\n    return () => {\n      if (connectionRef.current) {\n        connectionRef.current.stop();\n      }\n    };\n  }, []);\n\n  // --- SimÃ¼lasyon Kodu KaldÄ±rÄ±ldÄ± ---\n  // SimÃ¼lasyon kodlarÄ± artÄ±k gereksiz, Ã§Ã¼nkÃ¼ SignalR ile canlÄ± veri alacaÄŸÄ±z.\n\n  return /*#__PURE__*/_jsxDEV(MapContainer, {\n    center: center,\n    zoom: 15,\n    style: {\n      height: '100%',\n      width: '100%'\n    },\n    children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n      url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      attribution: \"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), uavPositions.map(uav => /*#__PURE__*/_jsxDEV(Marker, {\n      position: [uav.lat, uav.lng],\n      children: /*#__PURE__*/_jsxDEV(Popup, {\n        children: [\"\\u0130HA \", uav.num, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 39\n        }, this), \"\\u0130rtifa: \", uav.irtifa, \"m\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }, this)\n    }, uav.num, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }, this)), qrPosition && /*#__PURE__*/_jsxDEV(Marker, {\n      position: qrPosition,\n      icon: L.divIcon({\n        className: 'qr-icon',\n        html: '<div style=\"font-size: 24px;\">ðŸŽ¯</div>'\n      }),\n      children: /*#__PURE__*/_jsxDEV(Popup, {\n        children: \"QR Kodu Hedefi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }, this), hssZones.map(hss => /*#__PURE__*/_jsxDEV(Circle, {\n      center: [hss.hssEnlem, hss.hssBoylam],\n      radius: hss.hssYaricap,\n      pathOptions: {\n        color: 'red',\n        fillColor: '#f03',\n        fillOpacity: 0.3\n      },\n      children: /*#__PURE__*/_jsxDEV(Popup, {\n        children: [\"HSS \", hss.id, \" - Yasak B\\xF6lge (Yar\\u0131\\xE7ap: \", hss.hssYaricap, \"m)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }, this)\n    }, hss.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 9\n  }, this);\n};\n_s(MapView, \"goAvMgTqBvJSVj2ezSQSye763EI=\");\n_c = MapView;\nexport default MapView;\nvar _c;\n$RefreshReg$(_c, \"MapView\");","map":{"version":3,"names":["React","useState","useEffect","useRef","MapContainer","TileLayer","Marker","Circle","Popup","startSignalR","L","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","DEFAULT_CENTER","SERVER_BASE_URL","allUAVs","MapView","_s","uavPositions","setUAVPositions","qrPosition","setQrPosition","hssZones","setHssZones","center","setCenter","connectionRef","fetch","then","res","json","data","qrEnlem","qrBoylam","pos","catch","error","console","hss_koordinat_bilgileri","handleTelemetry","telemetryData","takim_numarasi","iha_enlem","iha_boylam","iha_irtifa","num","lat","lng","irtifa","Object","values","current","stop","zoom","style","height","width","children","url","attribution","fileName","_jsxFileName","lineNumber","columnNumber","map","uav","position","icon","divIcon","className","html","hss","hssEnlem","hssBoylam","radius","hssYaricap","pathOptions","color","fillColor","fillOpacity","id","_c","$RefreshReg$"],"sources":["/Users/beyza/Desktop/koustech/Client/src/map/mapView.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react'; \nimport { MapContainer, TileLayer, Marker, Circle, Popup } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css'; \nimport startSignalR from '../signalr/telemetriClient';\n\nimport L from 'leaflet';\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n    iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n    iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n    shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\n});\n\nconst DEFAULT_CENTER = [41.51, 36.12]; \nconst SERVER_BASE_URL = 'http://localhost:5000/api';\n\n// Ä°HA konumlarÄ±nÄ± Server'dan alacaÄŸÄ±mÄ±z iÃ§in, bunlarÄ± global bir ref'te tutalÄ±m (tÃ¼m Ä°HA'larÄ± simÃ¼le etmek iÃ§in)\nconst allUAVs = {};\n\nconst MapView = () => {\n    // State'ler\n    const [uavPositions, setUAVPositions] = useState([]); // CanlÄ± Ä°HA konumlarÄ±\n    const [qrPosition, setQrPosition] = useState(null); \n    const [hssZones, setHssZones] = useState([]); \n    const [center, setCenter] = useState(DEFAULT_CENTER);\n    const connectionRef = useRef(null); // SignalR baÄŸlantÄ±sÄ±nÄ± tutmak iÃ§in ref\n\n    // --- 1. BaÅŸlangÄ±Ã§ta Statik KonumlarÄ± (QR ve HSS) Ã‡ekme ---\n    useEffect(() => {\n        // QR ve HSS Ã§ekme kodlarÄ± aynÄ± kalÄ±r...\n        fetch(`${SERVER_BASE_URL}/qr_koordinati`)\n            .then(res => res.json())\n            .then(data => {\n                if (data.qrEnlem && data.qrBoylam) {\n                    const pos = [data.qrEnlem, data.qrBoylam];\n                    setQrPosition(pos);\n                    setCenter(pos); \n                }\n            })\n            .catch(error => console.error(\"QR Ã§ekilemedi:\", error));\n\n        fetch(`${SERVER_BASE_URL}/hss_koordinatlari`)\n            .then(res => res.json())\n            .then(data => {\n                if (data && data.hss_koordinat_bilgileri) {\n                    setHssZones(data.hss_koordinat_bilgileri);\n                }\n            })\n            .catch(error => console.error(\"HSS Ã§ekilemedi:\", error));\n    }, []);\n\n    // --- 2. SignalR Ä°stemcisine BaÄŸlanma ve CanlÄ± Veri AkÄ±ÅŸÄ± ---\n    useEffect(() => {\n        // Gelen telemetri verisini iÅŸleyen fonksiyon\n        const handleTelemetry = (telemetryData) => {\n            // Sadece konum ve numara bilgilerini alÄ±yoruz\n            const { takim_numarasi, iha_enlem, iha_boylam, iha_irtifa } = telemetryData;\n\n            // Global depoyu gÃ¼ncelle\n            allUAVs[takim_numarasi] = {\n                num: takim_numarasi,\n                lat: iha_enlem,\n                lng: iha_boylam,\n                irtifa: iha_irtifa,\n            };\n            \n            // State'i gÃ¼ncelle ve haritayÄ± yeniden Ã§izdir\n            setUAVPositions(Object.values(allUAVs));\n        };\n\n        // BaÄŸlantÄ±yÄ± baÅŸlat\n        connectionRef.current = startSignalR(handleTelemetry); \n\n        // Komponent temizlendiÄŸinde baÄŸlantÄ±yÄ± kapat\n        return () => {\n            if (connectionRef.current) {\n                connectionRef.current.stop();\n            }\n        };\n    }, []); \n\n    // --- SimÃ¼lasyon Kodu KaldÄ±rÄ±ldÄ± ---\n    // SimÃ¼lasyon kodlarÄ± artÄ±k gereksiz, Ã§Ã¼nkÃ¼ SignalR ile canlÄ± veri alacaÄŸÄ±z.\n\n\n    return (\n        <MapContainer center={center} zoom={15} style={{ height: '100%', width: '100%' }}>\n            <TileLayer\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n            />\n\n            {/* Ä°HA KonumlarÄ± */}\n            {uavPositions.map(uav => (\n                <Marker key={uav.num} position={[uav.lat, uav.lng]}>\n                    <Popup>\n                        Ä°HA {uav.num} <br/>\n                        Ä°rtifa: {uav.irtifa}m\n                    </Popup>\n                </Marker>\n            ))}\n\n            {/* QR Kod Konumu (Hedef) */}\n            {/* ... (Geri kalan kod aynÄ±) ... */}\n            {qrPosition && (\n                <Marker position={qrPosition} icon={L.divIcon({className: 'qr-icon', html: '<div style=\"font-size: 24px;\">ðŸŽ¯</div>'})}>\n                    <Popup>QR Kodu Hedefi</Popup>\n                </Marker>\n            )}\n\n            {/* HSS Yasak BÃ¶lgeleri (Ã‡emberler) */}\n            {hssZones.map(hss => (\n                <Circle \n                    key={hss.id} \n                    center={[hss.hssEnlem, hss.hssBoylam]} \n                    radius={hss.hssYaricap} \n                    pathOptions={{ color: 'red', fillColor: '#f03', fillOpacity: 0.3 }}\n                >\n                    <Popup>HSS {hss.id} - Yasak BÃ¶lge (YarÄ±Ã§ap: {hss.hssYaricap}m)</Popup>\n                </Circle>\n            ))}\n        </MapContainer>\n    );\n};\n\nexport default MapView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}